<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Guided meditation practice inspired by 'Churning the Ocean Within' by Millie Jess.">
    <meta name="keywords" content="guided meditation, breathing exercise, Om chanting, Solfeggio frequencies, mindfulness">
    <meta name="author" content="Millie Jess">
    <title>Churning the Ocean Within - Practice</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="menu-toggle">â˜°</div>
        <div class="logo">
            <h1>Churning the Ocean Within</h1>
            <h2>A Journey to Power, Wisdom, and Success</h2>
        </div>
        <nav class="nav-menu">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="practice.html">Practice</a></li>
                <li><a href="mood-tracker.html">Mood Tracker</a></li>
                <li><a href="journal.html">Journal</a></li>
                <li><a href="wisdom.html">Wisdom</a></li>
                <li><a href="book.html">Book</a></li>
                <li><a href="share.html">Share</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="meditation-container">
            <div class="pre-session">
                <h3>Pre-Session Mood Check</h3>
                <p>Select your current mood:</p>
                <div class="mood-options">
                    <div class="mood-emoji" onclick="selectMood('calm')">
                        ðŸ˜Œ <span>Calm</span>
                    </div>
                    <div class="mood-emoji" onclick="selectMood('stressed')">
                        ðŸ˜© <span>Stressed</span>
                    </div>
                    <div class="mood-emoji" onclick="selectMood('energized')">
                        ðŸ’ª <span>Energized</span>
                    </div>
                    <div class="mood-emoji" onclick="selectMood('healing')">
                        ðŸŒ¿ <span>Healing</span>
                    </div>
                </div>
                <p id="preMoodSelected"></p>
            </div>

            <div class="visualization">
                <div class="ocean-background"></div>
                <div class="serpent"></div>
                <div class="turtle"></div>
                <div class="treasure"></div>
                <div class="poison"></div>
                <div class="flame-animation"></div>
            </div>
            <input type="text" id="goalInput" placeholder="Set your goal/intention (Mount Mandara)">
            <button onclick="startMeditation()" class="cta-button">Start Churning</button>
            <p id="breathingGuidance">Breathe In</p>
            <div class="music-controls">
                <select class="frequency-select" id="frequencySelect">
                    <option value="none">Silent</option>
                    <option value="om">Om Chanting</option>
                    <option value="174">174Hz</option>
                    <option value="285">285Hz</option>
                    <option value="396">396Hz</option>
                    <option value="417">417Hz</option>
                    <option value="528">528Hz</option>
                    <option value="639">639Hz</option>
                    <option value="741">741Hz</option>
                    <option value="852">852Hz</option>
                    <option value="963">963Hz</option>
                </select>
                <button id="playButton" class="cta-button">Play</button>
                <button id="muteButton" class="cta-button">Mute</button>
            </div>
            <div id="meditationSteps"></div>
            <div id="eventDescription"></div>
            <a href="book.html" class="cta-button book-cta" style="display: none;">Excited? Buy the Book for More Wisdom!</a>
            <p id="streakTracker">Current Streak: 0 days</p>
            <div class="badges">
                <h3>Your Unlocked Treasures</h3>
                <div id="unlockedBadges"></div>
            </div>

            <div class="post-session">
                <h3>Post-Session Mood Check</h3>
                <p>Select your mood after meditation:</p>
                <div class="mood-options">
                    <div class="mood-emoji" onclick="selectPostMood('calm')">
                        ðŸ˜Œ <span>Calm</span>
                    </div>
                    <div class="mood-emoji" onclick="selectPostMood('stressed')">
                        ðŸ˜© <span>Stressed</span>
                    </div>
                    <div class="mood-emoji" onclick="selectPostMood('energized')">
                        ðŸ’ª <span>Energized</span>
                    </div>
                    <div class="mood-emoji" onclick="selectPostMood('healing')">
                        ðŸŒ¿ <span>Healing</span>
                    </div>
                </div>
                <p id="postMoodSelected"></p>
                <p id="moodComparison"></p>
            </div>

            <div class="compassion-practice">
                <h3>Compassion Practice</h3>
                <p>Send kindness to someone today:</p>
                <input type="text" id="kindnessPrompt" placeholder="Enter a name or 'self'">
                <button onclick="sendKindness()" class="cta-button">Send Kindness</button>
                <p id="kindnessFeedback"></p>
            </div>

            <div class="buddy-practice">
                <h3>Buddy Practice</h3>
                <p>Invite a friend to meditate together:</p>
                <input type="text" id="buddyCode" placeholder="Enter buddy code or generate one">
                <button onclick="syncBuddy()" class="cta-button">Sync with Buddy</button>
                <p id="buddyStatus">Sync status: Not connected</p>
            </div>

            <div class="book-integration">
                <h3>Deepen Your Journey</h3>
                <p>Explore more in the book *Churning the Ocean Within* by Millie Jess.</p>
                <a href="https://notionpress.com/in/read/churning-the-ocean-within" class="cta-button">Buy on Notion Press</a>
                <a href="https://amazon.com/churning-the-ocean-within" class="cta-button">Buy on Amazon</a>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Millie Jess. All rights reserved. | <a href="contact.html">Connect with Millie</a></p>
    </footer>

    <audio id="oceanSound" src="path/to/ocean-waves.mp3" loop></audio>
    <audio id="bellSound" src="path/to/soft-bell.mp3"></audio>
    <audio id="wellDoneVoice" src="path/to/well-done-voice.mp3"></audio>
    <audio id="kindnessVoice" src="path/to/kindness-voice.mp3"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const toggle = document.querySelector('.menu-toggle');
            const menu = document.querySelector('.nav-menu');
            if (toggle && menu) {
                toggle.addEventListener('click', () => {
                    menu.classList.toggle('active');
                });
            }

            let audio = new Audio('path/to/om.mp3'); // Replace with actual paths
            let isPlaying = false;
            let isMuted = false;

            const audioSources = {
                'none': '',
                'om': 'path/to/om-chanting.mp3',
                '174': 'path/to/174hz.mp3',
                '285': 'path/to/285hz.mp3',
                '396': 'path/to/396hz.mp3',
                '417': 'path/to/417hz.mp3',
                '528': 'path/to/528hz.mp3',
                '639': 'path/to/639hz.mp3',
                '741': 'path/to/741hz.mp3',
                '852': 'path/to/852hz.mp3',
                '963': 'path/to/963hz.mp3'
            };

            document.getElementById('playButton').addEventListener('click', () => {
                const freq = document.getElementById('frequencySelect').value;
                if (freq !== 'none' && !isPlaying) {
                    audio.src = audioSources[freq];
                    audio.play();
                    isPlaying = true;
                }
            });

            document.getElementById('muteButton').addEventListener('click', () => {
                isMuted = !isMuted;
                audio.muted = isMuted;
                document.getElementById('muteButton').textContent = isMuted ? 'Unmute' : 'Mute';
            });

            document.getElementById('frequencySelect').addEventListener('change', (e) => {
                audio.pause();
                isPlaying = false;
                const freq = e.target.value;
                if (freq !== 'none') {
                    audio.src = audioSources[freq];
                    if (!isMuted) audio.play();
                    isPlaying = true;
                }
            });

            // Pre-session mood selection
            window.selectMood = function(mood) {
                document.getElementById('preMoodSelected').textContent = `Pre-session mood: ${mood}`;
                localStorage.setItem('preMood', mood);
            };

            // Post-session mood selection
            window.selectPostMood = function(mood) {
                document.getElementById('postMoodSelected').textContent = `Post-session mood: ${mood}`;
                const preMood = localStorage.getItem('preMood');
                if (preMood) {
                    document.getElementById('moodComparison').textContent = `Mood change: ${preMood} â†’ ${mood}`;
                }
            };

            // Meditation flow
            const steps = [
                "Step 1: Set your determination (Mount Mandara) - Enter your goal.",
                "Step 2: Engage your inner energy (Vasuki) - Focus on the push-pull of breath.",
                "Step 3: Stabilize with faith (Kurma) - Remain steady.",
                "Step 4: Acknowledge positive and negative thoughts (Devas & Asuras).",
                "Step 5: Release negativity (Halahal).",
                "Step 6: Discover treasures (Strengths).",
                "Step 7: Attain wisdom (Amrit).",
                "Step 8: Avoid distractions (Mohini)."
            ];

            window.startMeditation = function() {
                const goal = document.getElementById('goalInput').value;
                if (!goal) {
                    alert('Please set a goal.');
                    return;
                }

                document.getElementById('oceanSound').play();
                let stepIndex = 0;
                const stepsDiv = document.getElementById('meditationSteps');
                stepsDiv.textContent = steps[stepIndex];

                const interval = setInterval(() => {
                    stepIndex++;
                    if (stepIndex < steps.length) {
                        stepsDiv.textContent = steps[stepIndex];
                        if (stepIndex === 4) showPoison();
                        if (stepIndex === 5) showTreasure();
                    } else {
                        clearInterval(interval);
                        completeSession();
                    }
                }, 10000); // 10 seconds per step

                // Breathing guidance with flame sync
                let inhale = true;
                setInterval(() => {
                    document.getElementById('breathingGuidance').textContent = inhale ? 'Inhale' : 'Exhale';
                    const flame = document.querySelector('.flame-animation');
                    flame.classList.add(inhale ? 'inhale-flame' : 'exhale-flame');
                    setTimeout(() => flame.classList.remove('inhale-flame', 'exhale-flame'), 4000);
                    inhale = !inhale;
                }, 4000); // 4 seconds per breath
            }

            function showPoison() {
                const poison = document.querySelector('.poison');
                poison.style.display = 'block';
                document.getElementById('eventDescription').textContent = 'A poison (negativity) has appeared. Acknowledge it.';
                setTimeout(() => {
                    poison.style.display = 'none';
                    increment('poisonsAcknowledged');
                }, 5000);
            }

            function showTreasure() {
                const treasure = document.querySelector('.treasure');
                treasure.style.display = 'block';
                treasure.classList.add('sparkle');
                document.getElementById('eventDescription').textContent = 'A treasure (strength) has emerged. Discover it.';
                setTimeout(() => {
                    treasure.style.display = 'none';
                    treasure.classList.remove('sparkle');
                    increment('treasuresDiscovered');
                }, 5000);
                document.getElementById('bellSound').play();
            }

            function increment(key) {
                let value = parseInt(localStorage.getItem(key) || '0') + 1;
                localStorage.setItem(key, value);
            }

            function completeSession() {
                increment('sessionsCompleted');
                increment('wisdomLevel');
                updateStreak();
                updateBadges();
                alert('Session completed! Treasure earned.');
                document.getElementById('bellSound').play();
                document.getElementById('wellDoneVoice').play();
                document.querySelector('.book-cta').style.display = 'block';
                document.querySelector('.post-session').style.display = 'block'; // Show post-session mood
            }

            function updateStreak() {
                const lastDate = localStorage.getItem('lastPracticeDate');
                const today = new Date().toDateString();
                let streak = parseInt(localStorage.getItem('streak') || '0');
                if (lastDate === today) {
                    // Already counted today
                } else if (lastDate === new Date(Date.now() - 86400000).toDateString()) {
                    streak++;
                } else {
                    streak = 1;
                }
                localStorage.setItem('streak', streak);
                localStorage.setItem('lastPracticeDate', today);
                document.getElementById('streakTracker').textContent = `Current Streak: ${streak} days`;
                document.getElementById('streakTracker').classList.add('glowing');
                setTimeout(() => document.getElementById('streakTracker').classList.remove('glowing'), 2000);
            }

            function updateBadges() {
                const sessions = parseInt(localStorage.getItem('sessionsCompleted') || '0');
                const badgesDiv = document.getElementById('unlockedBadges');
                badgesDiv.innerHTML = '';
                if (sessions >= 1) {
                    badgesDiv.innerHTML += '<div class="badge conch">Conch Unlocked</div>';
                }
                if (sessions >= 5) {
                    badgesDiv.innerHTML += '<div class="badge gem">Gem Unlocked</div>';
                }
                if (sessions >= 10) {
                    badgesDiv.innerHTML += '<div class="badge nectar">Nectar Drop Unlocked</div>';
                }
            }

            // Load initial streak and badges
            updateStreak();
            updateBadges();
        });
    </script>
</body>
</html>
